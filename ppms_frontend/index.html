<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PPMS - 생산공정관리시스템</title>
    
    <link rel="stylesheet" href="common.css">
    <link rel="stylesheet" href="index.css">
    <link href="https://hangeul.pstatic.net/hangeul_static/css/bmdohyeon.css" rel="stylesheet">
    <link href="https://hangeul.pstatic.net/hangeul_static/css/bmjua.css" rel="stylesheet">
    <link rel="stylesheet" href="https://unicons.iconscout.com/release/v2.1.9/css/unicons.css">
    <link href="https://fonts.googleapis.com/css?family=Poppins:400,500,600,700,800,900" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono" rel="stylesheet">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>

    <script src="auth.js"></script>
    <script src="logo.js"></script>

    
</head>

<body>
    <div class="page-container">

        <header class="main-header">
            <div class="header-left">
                <a href="index.html" class="ppms-logo-placeholder"></a>                
            </div>
            <div class="header-center">
                <div class="common-box">PPMS PROCESS</div>
            </div>
            <div class="header-right">
                <div class="common-box time-display" id="current-time">
                    <i class="uil uil-clock-eight"></i>
                    <span>Loading...</span>
                </div>
            </div>
        </header>

        <main class="content-area">
            <div class="flow-container">
                
                <a href="production.html" onclick="transitionToPage(event, 'production.html')">
                    <div class="grid-item">
                        <div class="icon-container">
                            <i class="uil uil-box main-icon"></i> <i class="uil uil-cog hover-icon"></i> </div>
                        <span>생 산</span>
                    </div>
                </a>
                
                <div class="flow-arrow">
                    
                    <i class="uil uil-angle-double-right flow-arrow-icon"></i>

                    <div class="branch-container">
                        
                        <div class="branch-line-dashed"></div>

                        <i class="uil uil-angle-double-up flow-arrow-icon-vertical"></i>

                        <a href="dip.html" class="branch-item-link" onclick="transitionToPage(event, 'dip.html')">
                            <div class="sub-grid-item">
                                <div class="icon-container">
                                    <i class="uil uil-processor main-icon"></i> 
                                    <i class="uil uil-circuit hover-icon"></i> 
                                </div>
                                <span>조 립</span>
                            </div>
                        </a>

                    </div>

                </div>
                
                <a href="aoi.html" onclick="transitionToPage(event, 'aoi.html')">
                    <div class="grid-item">
                        <div class="icon-container">
                            <i class="uil uil-eye main-icon"></i> 
                            <i class="uil uil-search-alt hover-icon"></i> 
                        </div>
                        <span>AOI</span>
                    </div>
                </a>
                
                <div class="flow-arrow">
                    <i class="uil uil-angle-double-right flow-arrow-icon"></i>
                </div>
                
                <a href="repair.html" onclick="transitionToPage(event, 'repair.html')">
                    <div class="grid-item">
                        <div class="icon-container">
                            <i class="uil uil-wrench main-icon"></i> 
                            <i class="uil uil-screw hover-icon"></i> 
                        </div>
                        <span>수 리</span>
                    </div>
                </a>
                
                <div class="flow-arrow">
                    <i class="uil uil-angle-double-right flow-arrow-icon"></i>
                </div>
                
                <a href="function_test.html" onclick="transitionToPage(event, 'function_test.html')">
                    <div class="grid-item">
                        <div class="icon-container">
                            <i class="uil uil-laptop main-icon"></i> 
                            <i class="uil uil-check-circle hover-icon"></i> 
                        </div>
                        <span>기 능</span>
                    </div>
                </a>

            </div>
        </main>

        <footer class="main-footer">
            <div class="footer-left" style="display: flex; gap: 10px;">
                <div class="footer-btn icon-backup">백업</div>
                <div class="footer-btn icon-restore">복원</div>
            </div>
            
            <div class="footer-center">
                <div class="common-box" id="footer-center-content" style="font-size: 0.9rem; opacity: 0.7;">
                    © PHILIA TELECOM
                </div>
            </div>
            
            <div class="footer-right">
                <div class="footer-btn icon-logout" id="logout-btn">Logout</div>
            </div>
        </footer>
    </div>

    <script>
        // [추가] 페이지 전환 함수 (페이드 아웃)
        function transitionToPage(e, url) {
            e.preventDefault();
            document.body.style.opacity = '0'; // 화면 투명하게
            setTimeout(() => {
                window.location.href = url;
            }, 500); // 0.5초 후 이동
        }

        // [기본 로직]
        document.addEventListener('DOMContentLoaded', () => {
            // 페이드 인 효과 (0 -> 1)
            setTimeout(() => {
                document.body.style.opacity = '1';
            }, 50);

            const userRole = localStorage.getItem('ppms_user_role');
            if (!userRole) {
                window.location.href = 'login.html';
                return;
            }

            setupLogoutButton();
            setInterval(updateTime, 1000);
            updateTime();

            const footerCenterContent = document.getElementById('footer-center-content');
            if (userRole === 'admin' && footerCenterContent) {
                const centerDiv = document.querySelector('.footer-center');
                centerDiv.innerHTML = ''; 
                
                const adminLink = document.createElement('a');
                adminLink.href = 'admin.html';
                
                const adminBtn = document.createElement('div');
                adminBtn.className = 'footer-btn'; // 아이콘 클래스 제거
                adminBtn.textContent = '관리자 페이지';
                adminBtn.style.color = '#ffeba7';
                
                adminLink.appendChild(adminBtn);
                centerDiv.appendChild(adminLink);
            }
        });

        function updateTime() {
            const timeDisplay = document.querySelector('#current-time span');
            if (!timeDisplay) return;
            const now = new Date();
            
            const year = now.getFullYear();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const day = String(now.getDate()).padStart(2, '0');
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            
            timeDisplay.textContent = `${year}.${month}.${day} ${hours}:${minutes}`;
        }
    </script>
</body>
</html>